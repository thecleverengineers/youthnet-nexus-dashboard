
RewriteEngine On

# Handle CORS preflight requests
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# API routes
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Auth routes
RewriteRule ^api/auth/register/?$ api/auth/register.php [L]
RewriteRule ^api/auth/login/?$ api/auth/login.php [L]
RewriteRule ^api/auth/logout/?$ api/auth/logout.php [L]
RewriteRule ^api/auth/profile/?$ api/auth/profile.php [L]
RewriteRule ^api/auth/refresh/?$ api/auth/refresh.php [L]

# Installation routes
RewriteRule ^api/install/validate/?$ api/install/validate.php [L]

# Health check
RewriteRule ^health/?$ health.php [L]

# Default fallback
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
